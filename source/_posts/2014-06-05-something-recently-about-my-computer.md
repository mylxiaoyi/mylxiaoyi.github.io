title: 不作不死－最近的电脑折腾
date: 2014-06-05 23:35
category: 
- 随笔
tags:
- linux
- nvidia
---

我现在所用的新笔记本是去年10月份购入的Aspire V3-571G，i5-3230M双核处理器、GT
730M独立显示、4G独立显存、1920x1080分辨率的IPS全高清屏，最重要的是5038的价格，正如网上大家的评价，这是一款性价比相当不错的笔记本。而我也希望能够在工作中充分发挥其性能，因而在来西安出差之前，特意更换了一块1T的硬盘，并加装了一条4G内存，从而使得内存容量达到8G。本希望他能够充分发挥其性能优势，然而在最近一段时间却给我带来不少的烦恼，而烦恼的根源就是GT730M独立显卡。

问题的起源是这样的：现在出差所在的单位，所有的开发工作都是在[Linux](http://www.linux.org)平台下完成的，由于受困于项目所需要的处理速度，理所当然的，我们希望能够使用[CUDA](https://developer.nvidia.com/cuda-zone)来加速我们项目的处理能力。然而由于我的笔记本是[Intel](http://www.intel.com)与[Nvidia](http://www.nvidia.com)双显卡，且由于Nvidia的Optimus技术，使得在Linux系统上安装Nvidia驱动并安装CUDA开发包变得困难起来。好在开源社区推出了Bumblebee解决方案，可以在Linux系统上实现Nvidia的3D硬件加速，从而使得在Linux系统下使用CUDA进行开发成为可能。然而悲催的是，不论我是使用源里的Nvidia驱动，还是在Nvidia官网下载的驱动，虽然都可以正常的安装，但却无法使用，更不要说CUDA开发了。在网上搜索了半天，原来遇到同样问题的人还不在少数，而问题的根源就在于Nvidia的Optimus技术，而解决方案就是[Bumblebee](http://bumblebee-project.org)。但是无论我怎样尝试，都没有办法在我的Debian上正常运行。难道我们的开发终归要回到Windows平台吗？

另一个促使我折腾的原因则是这样的：在我们的项目中使用[OpenCV](http://www.opencv.org)，在我第一次安装上[Debian](http://www.debian.org)系统，我是使用源里的OpenCV来进行安装的，然而由于Debian的自由策略，是不提供nonfree的安装模块的，而nonfree模块也正是我们所需要的，这样一来，我们只能自己来编译安装OpenCV了。然而在使用[CMake](http://www.cmake.org)进行配置时却有一大堆的依赖关系需要解决，这时的我只能在源中一个个查找然后安装了。这时的我真是有些怀念[Gentoo](http://www.gentoo.org)的编译安装啊。巧的是，布老师给我了一份CUDA SURF的代码让来看一下，而在这份代码的README中就说明，这份代码仅在Gentoo的CUDA环境下进行过测试。这就让我那颗的心蠢蠢欲动了。

最后一根压倒骆驼的稻草则是这样的：不知道是我Debian系统更新的原因，还是我OpenCV编译的原因，我们项目中的一个测试例子在显示两幅keypoints图片后，在两张图片之间切换时就会产生程序死掉样子的空白。再加上我再次尝试编译OpenCV时，以前能够成功编译的代码和配置在这次编译时却一直报错，在网上搜索了一下发现，似乎是由于FFMPEG的版本较新的原因。没有办法，自己重新由源码编译安装了FFMPEG，并修改了OpenCV的部分代码，才最终编译成功。而这更使我下定决定回归Gentoo的编译安装。

当时在我的1T硬盘上，系统分区则安装的情况是这样的：最前面是100M的系统保留分区，然后是400G的Debian分区，接下为200G左右的Windows分区，最后是一个逻辑分区。由于前面的想法，我就想在400G的Debian分区上划分200G出安装Gentoo，之前有过在Windows上使用分区软件划分分区的经验，通过使用PartitionMagic之类的软件，就可以对分区进行调整而不会破坏分区上的数据。然而这一次，无论我怎么尝试，都不能对Debian分区进行调整。无奈之后，只能重新分区重新安装系统了。于是将400G的Debia分区与前面的100M系统保留区分合并，重新划分为两个分区，一个用来安装Debian，而另一个用来安装Gentoo。两个系统安装完成后进行了简单的配置，于是重启，结果发现我的Win7系统进不去了，错误提示BOOTMSG丢失，这时才意识到我将100M的系统保留分区删除的严重后果。

为了恢复Win7系统的启动分区真是花费了很大的努力，各种修复方法都进行了尝试，然而无一例外的，所得到的都是令人失望的结果。终于在折腾在半夜后决定使用我的终极大法，重装Windows。

采用重装的方法，那一切就变得简单起来了，只需按照顺序重新安装，下载软件，配置等进行下来就可以了。这时所需要做的就是耐心的等待和地糟糕网速的容忍。不过好在这一切之后，一切又都恢复正常了。

这就是我最近很二的折腾电脑的经历。真是应了那句话no zuo no die啊！！！
